@import "variables";

@mixin icon($passed: (), $context: null, $deep: false, $strategy: 'merge') {
  $defs: (
    color: null,
    size: null,
    sizes: (
      auto: (
        size: 22px,
      ),
      tiny: (
        size: 11px,
      ),
      small: (
        size: 13px,
      ),
      normal: (
        size: 16px,
      ),
      large: (
        size: 20px,
      )
    )
  );

  $vars: $passed;
  $declare: false;

  $wrapper: null;
  @if $deep {
    $wrapper: '::ng-deep';
  }

  @if $passed == () or $strategy == 'merge' {
    $vars: map-merge($defs, $passed);
    $declare: true;
  }

  :host, #{$context} {
    @if $declare {
      display: inline-flex;
      vertical-align: middle;
    }

    &[type='font'] {
      #{$wrapper} [icon] {
        color: map-get($vars, color);
        font-size: if(map-get($vars, size), map-get($vars, size) !important, null);
      }
    }

    &[type='svg'], &[type='animated'] {
      #{$wrapper} [icon] {
        fill: map-get($vars, color);
        @if map-has-key($vars, size) {
          width: if(map-get($vars, size),  map-get($vars, size) !important, null);
          height: if(map-get($vars, size),  map-get($vars, size) !important, null);
        }
      }
    }

    @if map-has-key($vars, sizes) {
      @each $key, $size in map-get($vars, sizes) {
        &[size='#{$key}'] {
          &[type='font'] {
            &:not([size='auto']) {
              #{$wrapper} [icon] {
                font-size: map-get($size, size);
              }
            }
          }
          &[type='svg'], &[type='animated'] {
            #{$wrapper} [icon] {
              width: map-get($size, size);
              height: map-get($size, size);
            }
          }
        }
      }
    }
  }
}
