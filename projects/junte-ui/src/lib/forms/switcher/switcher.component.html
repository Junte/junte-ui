<ng-template #optionDefaultTemplate
             let-icon="option.icon"
             let-dot="option.dot"
             let-badge="option.badge"
             let-label="option.label"
             let-selected="selected">
  <jnt-dot *ngIf="dot" [color]="dot.color"></jnt-dot>
  <jnt-icon *ngIf="icon" data-icon [icon]="icon"></jnt-icon>

  <div *ngIf="marks" data-switch [attr.data-single]="mode === selectMode.single"><span *ngIf="selected" data-indicator></span></div>

  <jnt-stack [orientation]="ui.orientation.horizontal"
             [justify]="ui.flex.justify.between"
             [align]="ui.flex.align.center"
             [gutter]="ui.gutter.small"
             data-title>
    <div data-label>{{label}}</div>
    <jnt-badge *ngIf="badge"
               [position]="ui.position.inline"
               [color]="badge.color"
               [text]="badge.text"
               [value]="badge.value"
               [overflow]="badge.overflow">
    </jnt-badge>
  </jnt-stack>
</ng-template>

<div data-switcher>
  <div data-scroll>
    <jnt-stack [orientation]="orientation" [gutter]="ui.gutter.none" [align]="ui.flex.align.stretch" data-options>
      <ng-container *ngIf="!loading; else loadingTemplate">
        <jnt-stack data-option *ngFor="let option of options"
                   [attr.data-with-template]="option.optionTemplate"
                   [attr.data-selected]="option.value | check:selected:keyField:version"
                   [attr.data-disabled]="option.disabled"
                   (click)="select(option.value)"
                   [orientation]="ui.orientation.horizontal"
                   [align]="ui.flex.align.center"
                   [gutter]="ui.gutter.small"
                   tabindex="0">
          <ng-container
            *ngTemplateOutlet="!!option.optionTemplate ? option.optionTemplate : optionDefaultTemplate; context: {option: option, mode: mode, selected: option.value | check:selected:keyField:version }">
          </ng-container>
        </jnt-stack>
      </ng-container>
    </jnt-stack>
  </div>
</div>

<jnt-badge data-count *ngIf="!!features && features.includes(feature.badge) && mode === selectMode.multiple && selected.length > 0"
           [color]="ui.color.green"
           [value]="selected.length"></jnt-badge>

<jnt-button data-button *ngIf="!!features && features.includes(feature.selectAll) && mode === selectMode.multiple"
            [text]="'action.select_all' | translate"
            [outline]="ui.outline.transparent"
            [size]="ui.size.tiny"
            [scheme]="ui.scheme.secondary"
            (click)="selectAll()"></jnt-button>

<ng-template #loadingTemplate>
  <div data-placeholder *ngFor="let line of capacity | mockArray"></div>
</ng-template>
