@import "jnt-variables";
@import "jnt-functions";
@import "elements/icon/icon";
@import "layout/skeleton/skeleton";

@mixin jnt-switcher($passed: (), $context: null, $deep: false, $strategy: 'changes') {

  $defs: (
    corner: $jnt-corner-normal,
    horizontal: (
      height: 32px,
    ),
    vertical: (
      max-height: null,
    ),
    option: (
      active: (
        background: $jnt-primary-light-color,
        color: $jnt-white-color,
      ),
      align: null,
    )
  );

  $vars: $passed;
  $declare: false;
  $wrapper: null;

  @if $deep {
    $wrapper: '::ng-deep';
  }

  @if $passed == () or $strategy == 'merge' {
    $vars: recursive-map-merge($defs, $passed);
    $declare: true;
  }

  :host, #{$context} {
    @if $declare {
      display: block;
      position: relative;
      #{$wrapper} [data-options] {

        [data-option] {
          background-color: $jnt-primary-background;
          color: $jnt-primary-text-color;
          user-select: none;
          overflow: hidden;
          cursor: pointer;
          padding: 0 $jnt-gutter-small;

          &[data-with-template] {
            padding: $jnt-gutter-small;
          }

          &[data-selected="false"]:hover {
            background-color: $jnt-highlight-background;
          }

          &[data-disabled='true'] {
            color: $jnt-control-disabled-label-color;
            background-color: $jnt-control-disabled-background;
            pointer-events: none;
          }

          &:focus {
            box-shadow: $jnt-shadow-primary;
            outline: 0;
          }

          [data-title] {
            flex: 1;

            [data-label] {
              flex: 0 1 auto;
              overflow: hidden;
              white-space: nowrap;
            }
          }
        }
      }
    }

    &[data-orientation='vertical'] {
      @if map-has-key($vars, vertical) {
        $vertical: map-get($vars, vertical);
        @if map-get($vertical, max-height) != null {
          #{$wrapper} [data-scroll] {
            max-height: map-get($vertical, max-height);
            overflow-y: auto;
          }
        }
      }
    }

    &[data-orientation='horizontal'] {
      #{$wrapper} [data-options] {

        [data-option] {
          flex: auto;
          justify-content: center;
          @if map-has-key($vars, option) {
            $option: map-get($vars, option);
            [data-title] {
              justify-content: map-get($option, align);
            }
          }
        }
      }
    }

    &[data-disabled='true'] {
      cursor: default;
      pointer-events: none;

      #{$wrapper} [data-options] {
        [data-option] {
          color: $jnt-control-disabled-label-color;
          background-color: $jnt-control-disabled-background;
        }
      }
    }
  }

  #{$context} #{$wrapper} [data-switcher] {
    border: 1px solid $jnt-gray-700-color;
    border-radius: map-get($vars, corner);
    overflow: hidden;

    [data-options] {
      [data-option] {
        &[data-selected="true"] {
          @if map-has-key($vars, option) {
            $option: map-get($vars, option);
            @if map-has-key($option, active) {
              $active: map-get($option, active);
              color: map-get($active, color);
              background-color: map-get($active, background);
            }
          }
        }

        [data-icon] {
          @include jnt-icon((color: $jnt-primary-color, size: 16px), '&');
        }

        [data-switch] {
          position: relative;
          background-color: $jnt-control-background;
          border: 1px solid $jnt-primary-light-color;
          box-sizing: border-box;
          text-align: center;
          display: flex;
          justify-content: center;
          align-items: center;
          transition: all .3s;
          min-width: 18px;
          width: 18px;
          min-height: 18px;
          height: 18px;

          &[data-single='true'] {
            border-radius: 50%;

            [data-indicator] {
              border-radius: 50%;
            }
          }

          &[data-single='false'] {
            border-radius: $jnt-corner-base;

            [data-indicator] {
              border-radius: 2px;
            }
          }

          [data-indicator] {
            background-color: $jnt-primary-light-color;
            min-width: 10px;
            width: 10px;
            min-height: 10px;
            height: 10px;
          }
        }

        [data-title] {
          @if map-has-key($vars, horizontal) {
            $horizontal: map-get($vars, horizontal);
            line-height: map-get($horizontal, height);
          }
        }
      }
    }
  }

  #{$context} #{$wrapper} [data-count] {
    position: absolute;
    right: 0;
    top: 0;
    transform: translate(-50%, 50%);
  }

  #{$context} #{$wrapper} [data-placeholder] {
    width: 100%;

    &:nth-child(odd) {
      background-color: $jnt-highlight-background;
    }

    &:nth-child(even) {
      background-color: darken($jnt-highlight-background, 5%);
    }

    @if map-has-key($vars, horizontal) {
      $horizontal: map-get($vars, horizontal);
      height: map-get($horizontal, height);
    }
  }
}

