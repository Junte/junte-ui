<form [formGroup]="form">
  <div data-label *ngIf="!!label">{{label}}</div>
  <jnt-stack data-content [orientation]="ui.orientation.horizontal"
             [gutter]="ui.gutter.small" [align]="ui.align.center">
    <jnt-icon data-label-icon *ngIf="!!icon && !label && !multiline"
              [icon]="icon"></jnt-icon>

    <input #maskedInput *ngIf="!!mask; else inputTemplate"
           formControlName="formatted"
           type="tel"
           [name]="name"
           (focusin)="focused = true"
           (focusout)="focused = false"
           [placeholder]="mask"
           [readonly]="readonly ? readonly : null"
           [autocomplete]="autocomplete"
           (paste)="paste($event)"
           (keydown)="keydownMask($event)">

    <ng-template #inputTemplate>
      <input *ngIf="!multiline; else textareaTemplate"
             #valueInput
             formControlName="input"
             [name]="name"
             [type]="type === ui.input.type.password && view.password.display ? ui.input.type.text : type"
             [placeholder]="placeholder"
             [readonly]="readonly ? readonly : null"
             [autocomplete]="autocomplete"
             [min]="min"
             [max]="max"
             (focusin)="focused = true"
             (focusout)="focused = false"
             (keydown)="keydown($event)"
             (keyup)="keyup()">
    </ng-template>

    <ng-template #textareaTemplate>
      <textarea formControlName="input"
                [placeholder]="placeholder"
                [attr.rows]="rows"
                (focusin)="focused = true"
                (focusout)="focused = false">
      </textarea>
    </ng-template>

    <div data-loading *ngIf="state === ui.state.loading">
      <jnt-spinner data-spinner></jnt-spinner>
    </div>

    <div data-warning *ngIf="state === ui.state.warning">
      <jnt-icon [icon]="ui.icons.warning"></jnt-icon>
    </div>

    <div data-checked *ngIf="state === ui.state.checked">
      <jnt-icon [icon]="ui.icons.checked"></jnt-icon>
    </div>

    <button data-view *ngIf="type === ui.input.type.password"
            (click)="view.password.display = !view.password.display" tabindex="-1">
      <jnt-icon [icon]="view.password.display ? ui.icons.viewHide : ui.icons.view"></jnt-icon>
    </button>

    <button data-reset *ngIf="!!features && features | includes: feature.allowEmpty" tabindex="-1"
            (click)="clear($event)">
      <jnt-icon [icon]="ui.icons.cancel"></jnt-icon>
    </button>

    <div data-arrows *ngIf="type === ui.input.type.number">
      <button [disabled]="inputControl.disabled" (click)="up()" tabindex="-1">
        <jnt-icon [icon]="ui.icons.chevronUp"></jnt-icon>
      </button>
      <button [disabled]="inputControl.disabled" (click)="down()" tabindex="-1">
        <jnt-icon [icon]="ui.icons.chevronDown"></jnt-icon>
      </button>
    </div>

  </jnt-stack>

</form>
