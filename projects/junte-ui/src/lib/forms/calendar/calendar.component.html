<table>
  <thead>
  <tr>
    <td data-arrow-left>
      <button data-arrow (click)="period = subMonths(period, 1)">
        <jnt-icon [icon]="ui.icons.chevronLeft"></jnt-icon>
      </button>
    </td>
    <td colspan="5" data-date>
      {{period | dfnsFormat: 'LLLL'}}, {{period | dfnsFormat: 'yyyy'}}
    </td>
    <td data-arrow-right>
      <button data-arrow (click)="period = addMonths(period, 1)">
        <jnt-icon [icon]="ui.icons.chevronRight"></jnt-icon>
      </button>
    </td>
    <td *ngIf="metrics.length"
        [translate]="'label.metrics'"
        [attr.colspan]="metrics.length">
      Metrics
    </td>
  </tr>
  <tr data-days>
    <th *ngFor="let weekDay of [0,1,2,3,4,5,6]">{{weekDay | dfnsWeekdayName:'x2'}}</th>

    <th *ngFor="let m of metrics">
      {{m.title}}
    </th>
  </tr>
  </thead>

  <tbody>
  <tr *ngFor="let w of weeks"
      [attr.data-current-week]="(current | dfnsStartOfWeek) | dfnsIsEqual: (w.date | dfnsStartOfWeek)">
    <td data-day *ngFor="let d of w.days"
        [attr.data-current-day]="(d | dfnsStartOfDay) | dfnsIsEqual: (current | dfnsStartOfDay)"
        (click)="onChange(d)" tabindex="0">
      <ng-container
        *ngTemplateOutlet="!!calendarDayTemplate ? calendarDayTemplate: defaultDayTemplate;context:{date: d}">
      </ng-container>
    </td>

    <td data-metric *ngFor="let m of metrics;let i = index;">
      <ng-container *ngTemplateOutlet="calendarMetricTemplate;context:{metric: i, date: w.date}">
      </ng-container>
    </td>
  </tr>
  </tbody>
</table>

<ng-template #defaultDayTemplate let-date="date">
  <div data-default>{{date | dfnsGetDate}}</div>
</ng-template>

