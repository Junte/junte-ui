<div *ngIf="!!icon && !cardActionsTemplate" data-indicator>
  <jnt-icon [icon]="icon"></jnt-icon>
</div>

<jnt-stack data-card [orientation]="ui.orientation.horizontal" [gutter]="ui.gutter.none" [align]="ui.flex.align.stretch">
  <div data-line *ngIf="color" [style.background-color]="color"></div>

  <jnt-stack data-main [align]="ui.flex.align.stretch">
    <div *ngIf="!!headerTemplate" data-header>
      <ng-container *ngTemplateOutlet="headerTemplate"></ng-container>
    </div>
    <jnt-stack data-body
               [orientation]="ui.orientation.horizontal"
               (click)="!!features && features.includes(feature.clickable) ? selected.emit() : null">
      <div data-picture *ngIf="(!!picture || !!cardPictureTemplate) && picture.position === ui.position.left">
        <ng-container *ngIf="!!cardPictureTemplate; else cardImageTemplate">
          <ng-container *ngTemplateOutlet="cardPictureTemplate"></ng-container>
        </ng-container>
        <ng-template #cardImageTemplate>
          <img [src]="picture.url" [width]="picture.width" [height]="picture.height">
        </ng-template>
      </div>
      <div data-content>
        <div *ngIf="!!title || !!titleTemplate" data-title>
          <div data-text *ngIf="!!title && !titleTemplate">{{title}}</div>
          <ng-container *ngIf="!!titleTemplate">
            <ng-container *ngTemplateOutlet="titleTemplate"></ng-container>
          </ng-container>
        </div>
        <ng-content></ng-content>
      </div>
      <div data-picture *ngIf="(!!picture || !!cardPictureTemplate) && picture.position === ui.position.right">
        <ng-container *ngIf="!!cardPictureTemplate; else cardImageTemplate">
          <ng-container *ngTemplateOutlet="cardPictureTemplate"></ng-container>
        </ng-container>
        <ng-template #cardImageTemplate>
          <img [src]="picture.url" [width]="picture.width" [height]="picture.height">
        </ng-template>
      </div>
    </jnt-stack>

    <div *ngIf="!!footerTemplate" data-footer>
      <ng-container *ngTemplateOutlet="footerTemplate"></ng-container>
    </div>
  </jnt-stack>

</jnt-stack>

<jnt-button *ngIf="!!cardActionsTemplate"
            data-action
            [scheme]="ui.scheme.secondary"
            [size]="ui.size.small"
            [icon]="ui.icons.actions"
            (jntPopoverDisplayed)="popover = $event"
            [jntPopover]="{contentTemplate: dropdownTemplate, placement: ui.overlays.popover.placement.right, trigger: ui.overlays.popover.trigger.click}"></jnt-button>

<ng-template #dropdownTemplate>
  <ng-container *ngTemplateOutlet="cardActionsTemplate; context: {hide: hideActions.bind(this)}"></ng-container>
</ng-template>

<div *ngIf="state === cardState.loading" data-load>
  <jnt-spinner [size]="ui.size.large"></jnt-spinner>
</div>
<div *ngIf="state === cardState.error" data-error>
  <jnt-icon [icon]="ui.icons.sad"></jnt-icon>
</div>

