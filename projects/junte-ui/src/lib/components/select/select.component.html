<ng-template #ajaxOptionsTemp>
  <li item *ngFor="let option of ajaxOptions" (click)="optionSelect(option[valueField])">
    {{option[labelField]}}
  </li>
</ng-template>

<ng-template #optionsTemp>
  <li item *ngFor="let option of options" (click)="optionSelect(option[valueField])">
    <jnt-checkbox checkbox [checked]="!!selected[option[valueField]]">
      {{option[labelField]}}
    </jnt-checkbox>
  </li>
</ng-template>

<ng-template #singleMode>
  <li><span></span></li>
</ng-template>

<ng-template #selectedItemsTemp>
  <ul selection *ngIf="!loading; else loadOptionsTemp">
      <li [attr.chips]="mode === selectMode.multiple"
          *ngFor="let item of selectedItems">
        <span>{{labels[item]}}</span>
        <button (click)="optionSelect(item)">
          <jnt-icon close [icon]="ui.icons.close"></jnt-icon>
        </button>
      </li>
    <li>
      <input #searchInput input jntSmartWidth (click)="toggle = !toggle"
             [ngModel]="q"
             (ngModelChange)="search$.next($event)"
             [disabled]="!search">
      <ng-container *ngTemplateOutlet="placeholderTemp"></ng-container>
    </li>
  </ul>
</ng-template>

<ng-template #placeholderTemp>
  <div *ngIf="!selectedItems.length" placeholder>{{placeholder}}</div>
</ng-template>

<ng-template #loadTemp>
  <jnt-spinner [size]="ui.sizes.normal"></jnt-spinner>
</ng-template>

<ng-template #loadOptionsTemp>
  <jnt-spinner></jnt-spinner>
</ng-template>

<ng-template #itemsNotFoundTemp>
  <li message *ngIf="!!q && !options.length">Items not found</li>
</ng-template>

<div *ngIf="toggle" overlay (click)="toggle = !toggle"></div>

<div selectize (click)="input.focus(); toggle = !toggle;">
  <ng-container *ngTemplateOutlet="selectedItemsTemp"></ng-container>
  <jnt-icon icon [icon]="ui.icons.sortDown"></jnt-icon>
  <ng-container *ngIf="!!toggle">
    <div options>
      <div *ngIf="loading" loading>
        <ng-container *ngTemplateOutlet="loadTemp"></ng-container>
      </div>
      <ul>
        <ng-container *ngTemplateOutlet="itemsNotFoundTemp"></ng-container>
        <ng-container *ngTemplateOutlet="optionsTemp"></ng-container>
        <ng-container *ngTemplateOutlet="ajaxOptionsTemp"></ng-container>
      </ul>
    </div>
  </ng-container>
</div>

<ng-content></ng-content>
