@import "variables";

@mixin col-padding($padding) {
  & {
    padding-left: $padding;
    padding-right: $padding;
  }
}

@mixin grid-col($passed: (), $context: null, $strategy: 'changes') {

  $defs: (
    grid-columns: 12,
    padding: (
      tiny: $gutter-tiny,
      small: $gutter-small,
      normal: $gutter-normal,
      big: $gutter-big,
      large: $gutter-large,
      huge: $gutter-huge,
    ),
  );

  $vars: $passed;
  $declare: false;

  @if $passed == () or $strategy == 'merge' {
    $vars: map-merge($defs, $passed);
    $declare: true;
  }

  :host, #{$context} {
    display: block;
    box-sizing: border-box;
    position: relative;

    @if map-has-key($vars, padding) {
      $padding: map-get($vars, padding);
      @each $padding, $map in $padding {
        &[padding = '#{$padding}'] {
          @include col-padding($map);
        }
      }
    }

    @each $breakpoints, $value in $grid-breakpoints {
      @media screen and (min-width: $value) {
        @for $i from 1 through map-get($vars, grid-columns) {
          &[#{$breakpoints} = '#{$i}'] {
            $width: $i/map-get($vars, grid-columns);
            flex: 0 0 percentage($width);
            max-width: percentage($width);
          }
        }
      }
    }

    @for $i from 1 through map-get($vars, grid-columns) {
      &[span = "#{$i}"] {
        $width: $i/map-get($vars, grid-columns);
        flex: 0 0 percentage($width);
        max-width: percentage($width);
      }
    }
  }
}
